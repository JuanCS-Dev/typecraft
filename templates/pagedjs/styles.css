/* 
 * Paged.js CSS Template
 * Typecraft Editorial Automation System
 * 
 * Based on:
 * - Van de Graaf Canon for page construction
 * - MÃ¼ller-Brockmann grid system
 * - CSS Paged Media Level 3 specification
 */

/* ============================================
   PAGE SETUP - CSS Paged Media
   ============================================ */

@page {
    size: 6in 9in;
    margin: 0.75in 1in 1.125in 0.5in; /* Van de Graaf Canon proportions 2:3:4:6 */
    
    /* Running Headers */
    @top-center {
        content: string(book-title);
        font-family: Georgia, serif;
        font-size: 9pt;
        color: #666;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }
    
    /* Page Numbers */
    @bottom-center {
        content: counter(page);
        font-family: Georgia, serif;
        font-size: 10pt;
    }
}

/* First page - no headers/footers */
@page :first {
    @top-center {
        content: none;
    }
    @bottom-center {
        content: none;
    }
}

/* Left pages (verso) */
@page :left {
    margin-left: 1in;
    margin-right: 0.5in;
    
    @top-left {
        content: counter(page);
    }
    @top-center {
        content: string(chapter-title);
    }
}

/* Right pages (recto) */
@page :right {
    margin-left: 0.5in;
    margin-right: 1in;
    
    @top-right {
        content: counter(page);
    }
    @top-center {
        content: string(book-title);
    }
}

/* Chapter opening pages */
@page chapter {
    @top-center {
        content: none;
    }
    @top-left {
        content: none;
    }
    @top-right {
        content: none;
    }
}

/* ============================================
   TYPOGRAPHY - Body Text
   ============================================ */

:root {
    /* Typographic scale (1.2 minor third) */
    --font-size-base: 10pt;
    --font-size-h1: 24pt;
    --font-size-h2: 20pt;
    --font-size-h3: 16.8pt;
    --font-size-h4: 14pt;
    --font-size-h5: 12pt;
    --font-size-h6: 10pt;
    
    /* Vertical rhythm (baseline grid) */
    --line-height: 1.5;
    --baseline: calc(var(--font-size-base) * var(--line-height));
    
    /* Colors */
    --color-text: #1a1a1a;
    --color-heading: #000000;
    --color-accent: #2563eb;
    --color-muted: #666666;
}

body {
    font-family: 'Source Serif Pro', Georgia, serif;
    font-size: var(--font-size-base);
    line-height: var(--line-height);
    color: var(--color-text);
    hyphens: auto;
    hyphenate-limit-chars: 6 3 3;
    text-align: justify;
    widows: 3;
    orphans: 3;
}

/* ============================================
   HEADINGS
   ============================================ */

h1, h2, h3, h4, h5, h6 {
    font-family: 'Source Sans Pro', Arial, sans-serif;
    color: var(--color-heading);
    line-height: 1.2;
    font-weight: 600;
    page-break-after: avoid;
    break-after: avoid;
    string-set: chapter-title content();
}

h1 {
    font-size: var(--font-size-h1);
    page: chapter;
    break-before: page;
    margin-top: 0;
    margin-bottom: calc(var(--baseline) * 2);
    text-align: center;
    font-weight: 700;
}

h2 {
    font-size: var(--font-size-h2);
    margin-top: calc(var(--baseline) * 2);
    margin-bottom: var(--baseline);
}

h3 {
    font-size: var(--font-size-h3);
    margin-top: calc(var(--baseline) * 1.5);
    margin-bottom: calc(var(--baseline) * 0.5);
}

h4 {
    font-size: var(--font-size-h4);
    margin-top: var(--baseline);
    margin-bottom: calc(var(--baseline) * 0.5);
}

/* ============================================
   PARAGRAPHS
   ============================================ */

p {
    margin: 0 0 var(--baseline) 0;
    text-indent: 1.5em;
}

/* First paragraph after heading - no indent */
h1 + p,
h2 + p,
h3 + p,
h4 + p,
section > p:first-of-type {
    text-indent: 0;
}

/* ============================================
   LISTS
   ============================================ */

ul, ol {
    margin: var(--baseline) 0;
    padding-left: 2em;
}

li {
    margin: calc(var(--baseline) * 0.5) 0;
}

/* ============================================
   CODE BLOCKS
   ============================================ */

code {
    font-family: 'Courier New', monospace;
    background-color: #f5f5f5;
    padding: 0.2em 0.4em;
    border-radius: 3px;
    font-size: 0.9em;
}

pre {
    background-color: #f5f5f5;
    padding: 1em;
    border-radius: 5px;
    overflow-x: auto;
    page-break-inside: avoid;
    margin: var(--baseline) 0;
}

pre code {
    background-color: transparent;
    padding: 0;
}

/* ============================================
   BLOCKQUOTES
   ============================================ */

blockquote {
    margin: var(--baseline) 2em;
    padding-left: 1em;
    border-left: 3px solid var(--color-accent);
    font-style: italic;
    color: var(--color-muted);
}

/* ============================================
   IMAGES AND FIGURES
   ============================================ */

img {
    max-width: 100%;
    height: auto;
    page-break-inside: avoid;
}

figure {
    margin: var(--baseline) 0;
    page-break-inside: avoid;
    text-align: center;
}

figcaption {
    font-size: 0.9em;
    color: var(--color-muted);
    margin-top: calc(var(--baseline) * 0.5);
}

/* ============================================
   TABLES
   ============================================ */

table {
    width: 100%;
    border-collapse: collapse;
    margin: var(--baseline) 0;
    page-break-inside: avoid;
}

th, td {
    border: 1px solid #ddd;
    padding: 0.5em;
    text-align: left;
}

th {
    background-color: #f5f5f5;
    font-weight: bold;
}

/* ============================================
   LINKS
   ============================================ */

a {
    color: var(--color-accent);
    text-decoration: none;
}

a:hover {
    text-decoration: underline;
}

/* Print URLs after links */
a[href]:after {
    content: " (" attr(href) ")";
    font-size: 0.8em;
    color: var(--color-muted);
}

/* ============================================
   UTILITIES
   ============================================ */

.page-break {
    page-break-before: always;
    break-before: page;
}

.no-break {
    page-break-inside: avoid;
    break-inside: avoid;
}

/* Chapter number */
.chapter-number {
    display: block;
    font-size: var(--font-size-h4);
    color: var(--color-muted);
    margin-bottom: calc(var(--baseline) * 0.5);
    text-transform: uppercase;
    letter-spacing: 0.1em;
}
